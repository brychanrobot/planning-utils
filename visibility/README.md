ported from `https://github.com/Silverwolf90/2d-visibility.git`